<div class="mi-actividad">
  <h1>MIS CLASES - Turnos del Mes</h1>

  <!-- Selector de mes -->
  <div style="margin-bottom: 1.5rem;">
    <%= form_with url: mi_actividad_path, method: :get, local: true, data: { turbo_frame: "reservations" } do |f| %>
      <%= f.month_field :date, value: @date.strftime("%Y-%m"), class: "form-input" %>
      <%= f.submit "Ver mes", class: "btn btn-primary" %>
    <% end %>
  </div>

  <!-- Reservas del mes con Turbo Frame -->
  <%= turbo_frame_tag "reservations" do %>
    <div class="card">
      <div class="card-header">
        Turnos de <%= @date.strftime("%B %Y") %>
      </div>
      
      <% if @reservations.any? %>
        <ul style="list-style: none; padding: 0;">
          <% @reservations.each do |reservation| %>
            <li class="reservation-item" style="padding: 1rem; border-bottom: 1px solid #eee;">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <strong><%= reservation.pilates_class.name %></strong>
                  <p style="margin: 0.25rem 0; color: #666;">
                    <%= reservation.pilates_class.start_time.strftime("%d/%m/%Y %H:%M") %> - 
                    <%= reservation.pilates_class.end_time.strftime("%H:%M") %>
                  </p>
                  <p style="margin: 0.25rem 0; color: #666;">
                    <%= reservation.pilates_class.room.name %>
                  </p>
                  <span class="badge badge-<%= reservation.status %>">
                    <%= reservation.status.humanize %>
                  </span>
                </div>
                <% if reservation.confirmed? %>
                  <%= button_to "Cancelar", reservation_path(reservation), 
                      method: :delete,
                      class: "btn btn-danger",
                      data: { turbo_frame: "_top", confirm: "¿Estás seguro de cancelar esta reserva?" } %>
                <% end %>
              </div>
            </li>
          <% end %>
        </ul>
      <% else %>
        <p>No tienes turnos reservados para este mes</p>
      <% end %>
    </div>
  <% end %>
</div>

