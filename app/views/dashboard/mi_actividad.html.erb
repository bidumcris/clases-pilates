<div class="mi-actividad">
  <h1>MIS CLASES</h1>

  <p style="margin-bottom: 1rem; opacity: .85;">
    Solo podés ver y gestionar turnos de la <strong>semana actual</strong> (lun–vie).
  </p>

  <!-- Reservas de la semana actual (sin selector: no se permite ver otras semanas) -->
  <%= turbo_frame_tag "reservations" do %>
    <div class="card">
      <div class="card-header">
        Semana del <%= I18n.l(@week_start, format: "%d/%m") %> al <%= I18n.l(@week_end, format: "%d/%m/%Y") %>
      </div>
      
      <% if @reservations.any? %>
        <ul style="list-style: none; padding: 0;">
          <% @reservations.each do |reservation| %>
            <li class="reservation-item" style="padding: 1rem; border-bottom: 1px solid #eee;">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <strong><%= reservation.pilates_class.name %></strong>
                  <p style="margin: 0.25rem 0; color: #666;">
                    <%= reservation.pilates_class.start_time.strftime("%d/%m/%Y %H:%M") %> - 
                    <%= reservation.pilates_class.end_time.strftime("%H:%M") %>
                  </p>
                  <p style="margin: 0.25rem 0; color: #666;">
                    <%= reservation.pilates_class.room.name %>
                  </p>
                  <span class="badge badge-<%= reservation.status %>">
                    <%= reservation.status.humanize %>
                  </span>
                </div>
                <% if reservation.confirmed? %>
                  <%= button_to "Cancelar", reservation_path(reservation), 
                      method: :delete,
                      class: "btn btn-danger",
                      data: { turbo_frame: "_top", confirm: "¿Estás seguro de cancelar esta reserva?" } %>
                <% end %>
              </div>
            </li>
          <% end %>
        </ul>
      <% else %>
        <p>No tenés turnos reservados para esta semana.</p>
        <p><%= link_to "Ir al calendario para reservar", agenda_path, class: "btn btn-primary", data: { turbo_frame: "_top" } %></p>
      <% end %>
    </div>
  <% end %>
</div>

